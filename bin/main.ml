open! Benchmark

(* let () = Mono_poly.bench () *)
(*
┌───────────────────────────┬──────────┬────────────┐
│ Name                      │ Time/Run │ Percentage │
├───────────────────────────┼──────────┼────────────┤
│ Monomorphic large pattern │   7.72ns │     60.57% │
│ Monomorphic small pattern │   9.57ns │     75.07% │
│ Polymorphic large pattern │  12.74ns │    100.00% │
└───────────────────────────┴──────────┴────────────┘
*)

(* let () = Tail_ref.bench () *)
(*
┌───────────────────┬────────────┬─────────┬──────────┬──────────┬────────────┐
│ Name              │   Time/Run │ mWd/Run │ mjWd/Run │ Prom/Run │ Percentage │
├───────────────────┼────────────┼─────────┼──────────┼──────────┼────────────┤
│ Tail-recursion    │   939.76ns │         │          │          │     22.95% │
│ Reference         │   899.81ns │         │          │          │     21.97% │
│ Stdlib fold left  │ 1_842.85ns │         │          │          │     45.00% │
│ Stdlib fold right │ 2_270.13ns │         │          │          │     55.44% │
│ Base fold left    │ 1_862.12ns │         │          │          │     45.47% │
│ Base fold right   │ 4_094.90ns │  3.01kw │   17.32w │   17.32w │    100.00% │
└───────────────────┴────────────┴─────────┴──────────┴──────────┴────────────┘
*)

(* let () = Async_bench.bench () *)
(*
┌──────────────────┬──────────┬─────────┬──────────┬──────────┐
│ Name             │ Time/Run │ mWd/Run │ mjWd/Run │ Prom/Run |
├──────────────────┼──────────┼─────────┼──────────┼──────────┤
│ Async list fold  │ 246.33ns │  32.00w │   33.67w │   22.00w |
│ Async list foldi │ 192.44ns │  27.00w │   23.97w │   17.00w │
│ Async list iter  │ 299.91ns │  43.00w │   49.96w │   33.01w │ 
│ Async list iteri │ 302.44ns │  39.00w │   45.96w │   29.01w │
└──────────────────┴──────────┴─────────┴──────────┴──────────┘
*)

(* let () = Lwt_bench.bench () *)
(*
┌────────────────┬──────────┬─────────┬──────────┬──────────┬────────────┐
│ Name           │ Time/Run │ mWd/Run │ mjWd/Run │ Prom/Run │ Percentage │
├────────────────┼──────────┼─────────┼──────────┼──────────┼────────────┤
│ Lwt fold left  │  14.43us │ 30.05kw │    0.89w │    0.89w │     83.33% │
│ Lwt fold right │  17.32us │ 33.05kw │  191.28w │  191.28w │    100.00% │
│ Lwt iter p     │   9.76us │  7.07kw │   97.36w │   97.36w │     56.34% │
│ Lwt iteri p    │  16.86us │ 17.08kw │  231.81w │  231.81w │     97.37% │
│ Lwt iter s     │  11.86us │ 25.05kw │    1.30w │    1.30w │     68.47% │
│ Lwt iteri s    │  14.19us │ 31.05kw │    1.87w │    1.87w │     81.96% │
└────────────────┴──────────┴─────────┴──────────┴──────────┴────────────┘
*)
